# Vulnerability Assessment Agent

## Overview

The **Vulnerability Assessment Agent** provides comprehensive vulnerability scanning, risk prioritization, and remediation tracking capabilities. This agent helps organizations identify, assess, and manage security vulnerabilities across their infrastructure.

## Core Capabilities

### 1. Automated Scanning
Perform systematic vulnerability scans:
- **Host-based Scanning**: Scan individual systems
- **Network Scanning**: Assess entire network ranges
- **Web Application Scanning**: Test web applications
- **Cloud Security Assessment**: Evaluate cloud configurations
- **Container Scanning**: Analyze container images
- **API Testing**: Test API endpoints

### 2. Vulnerability Intelligence
Access and utilize threat intelligence:
- **CVE Lookup**: Search vulnerability databases
- **Threat Feeds**: Real-time threat data
- **Exploit Availability**: Check public exploits
- ** forPatch Information**: Identify available fixes
- **Zero-Day Tracking**: Monitor emerging threats

### 3. Risk Scoring
Calculate and prioritize vulnerabilities:
- **CVSS Scoring**: Standard severity metrics
- **Custom Risk Models**: Business context scoring
- **Asset Criticality**: Weight by asset importance
- **Exploit likelihood**: Probability of exploitation
- **Remediation Priority**: Order by urgency

### 4. Compliance Checking
Validate against security frameworks:
- **PCI-DSS**: Payment card standards
- **SOC 2**: Service organization controls
- **HIPAA**: Healthcare data protection
- **ISO 27001**: Information security
- **NIST CSF**: Cybersecurity framework

### 5. Remediation Tracking
Manage vulnerability resolution:
- **Remediation Plans**: Create fix strategies
- **Progress Tracking**: Monitor resolution status
- **SLAs**: Track compliance with timelines
- **Reporting**: Document remediation progress
- **Verification**: Confirm fixes are effective

## Usage Examples

### Network Scanning

```python
from vulnerability_assessment import VulnerabilityScanner

scanner = VulnerabilityScanner()
results = scanner.scan_host("192.168.1.100", scan_type="full")
print(f"Findings: {len(results['findings'])} vulnerabilities")

network = scanner.scan_network("192.168.1.0/24")
print(f"Hosts scanned: {network['hosts_scanned']}")
print(f"Critical: {network['vulnerability_summary']['critical']}")
```

### Web Application Scanning

```python
web_scan = scanner.scan_web_application(
    "https://example.com",
    scan_depth="medium"
)
for vuln in web_scan['vulnerabilities']:
    print(f"{vuln['type']}: {vuln['severity']} - {vuln['url']}")
```

### Cloud Security Assessment

```python
cloud = scanner.scan_cloud_infrastructure(
    provider="AWS",
    credentials={'access_key': '...'}
)
for finding in cloud['findings']:
    print(f"{finding['issue']} ({finding['severity']})")
print(f"Compliance Score: {cloud['compliance_score']}%")
```

### CVE Lookup

```python
from vulnerability_assessment import VulnerabilityDatabase

db = VulnerabilityDatabase()
cve = db.lookup_cve("CVE-2021-44228")
print(f"CVSS Score: {cve['cvss_v3_score']}")
print(f"Description: {cve['description'][:100]}...")
print(f"Exploits Available: {cve['exploits_available']}")
```

### Risk Prioritization

```python
from vulnerability_assessment import RiskCalculator

risk = RiskCalculator()
priority = risk.prioritize_vulnerabilities(
    [
        {'cve_id': 'CVE-2021-44228', 'cvss': 10.0, 'asset': 'web-server'},
        {'cve_id': 'CVE-2022-22965', 'cvss': 9.8, 'asset': 'app-server'}
    ],
    asset_criticality={'web-server': 1.5}
)
for p in priority:
    print(f"{p['vuln_id']}: {p['priority']} (Score: {p['priority_score']:.1f})")
```

### Compliance Checking

```python
from vulnerability_assessment import ComplianceChecker

compliance = ComplianceChecker()
pci = compliance.check_compliance('PCI-DSS', {})
print(f"PCI-DSS Compliance: {pci['compliance_status']}")
print(f"Score: {pci['compliance_score']:.1f}%")

soc2 = compliance.check_compliance('SOC2', {})
print(f"SOC 2 Compliance: {soc2['compliance_status']}")
```

## Vulnerability Assessment Framework

```
┌─────────────────────────────────────────────────────────┐
│              Vulnerability Assessment Process            │
├─────────────────────────────────────────────────────────┤
│  1. Discovery → 2. Assessment → 3. Analysis             │
│         │              │              │                  │
│  6. Report ← 5. Track ← 4. Prioritize                  │
│         │              │              │                  │
│         └──────────────┴──────────────┘
└─────────────────────────────────────────────────────────┘
```

## Common Vulnerability Types

### Network Vulnerabilities

| Category | Examples | Severity |
|----------|----------|----------|
| Missing Patches | CVE-2021-44228, EternalBlue | Critical |
| Misconfigurations | Default creds, Open ports | High |
| Protocol Weaknesses | SSL/TLS issues, Weak encryption | Medium |
| Service Issues | Unnecessary services, Banners | Low |

### Web Application Vulnerabilities

| Category | OWASP | Description |
|----------|-------|-------------|
| Injection | A03:2021 | SQL, Command, LDAP injection |
| Broken Auth | A07:2021 | Weak authentication |
| XSS | A03:2021 | Cross-site scripting |
| SSRF | A10:2021 | Server-side request forgery |
| Access Control | A01:2021 | Authorization bypass |

### Cloud Vulnerabilities

| Issue | Provider | Risk |
|-------|----------|------|
| Public S3 Buckets | AWS | High |
| Over-permissioned IAM | All | High |
| Open Security Groups | AWS | Critical |
| Unencrypted Storage | All | Medium |
| Missing Logging | All | Medium |

## CVSS Scoring Guide

### Base Score Metrics

| Metric | Values | Impact |
|--------|--------|--------|
| Attack Vector (AV) | Network, Adjacent, Local, Physical | High to Low |
| Attack Complexity (AC) | Low, High | Normal to Reduced |
| Privileges Required (PR) | None, Low, High | None to All |
| User Interaction (UI) | None, Required | Normal to Reduced |
| Scope (S) | Unchanged, Changed | Normal to Expanded |
| Confidentiality (C) | None, Low, High | No Impact to Total |
| Integrity (I) | None, Low, High | No Impact to Total |
| Availability (A) | None, Low, High | No Impact to Total |

### Severity Ratings

| CVSS Score | Severity | Color |
|------------|----------|-------|
| 0.0 - 3.9 | Low | Green |
| 4.0 - 6.9 | Medium | Yellow |
| 7.0 - 8.9 | High | Orange |
| 9.0 - 10.0 | Critical | Red |

## Remediation Strategies

### Patch Management

1. **Asset Inventory**: Know what you have
2. **Vulnerability Feed**: Monitor CVE databases
3. **Prioritization**: Patch critical first
4. **Testing**: Test patches before deployment
5. **Deployment**: Roll out systematically
6. **Verification**: Confirm installation

### Configuration Hardening

1. **Baselines**: Define secure configurations
2. **Scanning**: Check against baselines
3. **Remediation**: Fix deviations
4. **Automation**: Use configuration management
5. **Monitoring**: Detect configuration drift

### Workarounds When Patching Isn't Possible

1. **Network Segmentation**: Isolate vulnerable systems
2. **Web Application Firewall**: Block attack patterns
3. **Virtual Patching**: Block exploitation at perimeter
4. **Compensating Controls**: Add additional security
5. **Monitoring**: Increase detection capabilities

## Compliance Requirements

### PCI-DSS Key Requirements

| Requirement | Control | Frequency |
|-------------|---------|-----------|
| 6.4.3 | WAF protection | Continuous |
| 8.3 | MFA for remote access | Continuous |
| 10.2 | Audit logging | Daily review |
| 11.2 | Vulnerability scans | Quarterly |
| 11.3 | Penetration testing | Annually |

### HIPAA Technical Safeguards

| Rule | Control | Requirement |
|------|---------|-------------|
| 164.312(a) | Access control | Unique IDs, emergency access |
| 164.312(b) | Audit controls | Record and examine activity |
| 164.312(c) | Integrity controls | Protect against alteration |
| 164.312(d) | Authentication | Verify entity |
| 164.312(e) | Transmission security | Encryption, integrity |

## Tools and Platforms

### Commercial Scanners

| Tool | Strength | Best For |
|------|----------|----------|
| Qualys | Cloud-based | Large enterprises |
| Tenable.io | Integration | DevSecOps |
| Rapid7 | Vulnerability management | Medium businesses |
| Nessus | Comprehensive | All sizes |

### Open Source Scanners

| Tool | Purpose | Features |
|------|---------|----------|
| OpenVAS | Full scan | Large plugin library |
| Nikto | Web server | Quick assessment |
| OWASP ZAP | Web app | Interactive testing |
| Nmap | Network | Port discovery |

## Metrics and KPIs

### Key Metrics

| Metric | Target | Description |
|--------|--------|-------------|
| Mean Time to Detect (MTTD) | < 24h | Time to find vulnerabilities |
| Mean Time to Respond (MTTR) | < 7d | Time to remediate |
| Vulnerability Age | < 30d | Average age of open vulns |
| Compliance Score | > 90% | Security control coverage |
| False Positive Rate | < 10% | Invalid findings |

### Dashboard Metrics

- Vulnerabilities by severity (critical, high, medium, low)
- Remediation progress and trends
- Asset risk scores
- Compliance status by framework
- SLA compliance rates

## Best Practices

1. **Regular Scanning**: Schedule consistent scans
2. **Comprehensive Coverage**: Scan all assets
3. **Risk-Based Prioritization**: Focus on critical risks
4. **Track to Completion**: Monitor remediation
5. **Validate Fixes**: Confirm vulnerabilities are resolved
6. **Automate Where Possible**: Reduce manual effort
7. **Integrate with Workflows**: Embed in SDLC and operations

## Related Skills

- [Penetration Testing](./../red-team/penetration-testing/resources/GROK.md) - Manual testing
- [Security Monitoring](./../blue-team/security-monitoring/resources/GROK.md) - Continuous monitoring
- [Threat Modeling](./../threat-modeling/resources/GROK.md) - Proactive identification
- [Secure Coding](./../secure-coding/resources/GROK.md) - Prevention through development

---

**File Path**: `skills/security-assessment/vulnerability-assessment/resources/vulnerability_assessment.py`
